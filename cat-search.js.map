{"version":3,"file":"cat-search.js","sources":["../src/js/cat-search.js"],"sourcesContent":["import {\n  fetchBreeds,\n  fetchCatByBreed,\n  fetchBreedImages,\n  saveImageToFavorites,\n  getFavourites,\n} from './api';\nimport { notifications } from '../utils/notifications';\nimport SlimSelect from \"slim-select\";\n\n\nconst selectEl = document.querySelector(\".breed-form_select\");\nconst selectArrow = document.querySelector('.custom-arrow');\nconst gallery = document.querySelector('.cat-gallery');\nconst catInfo = document.querySelector('.cat-info');\nconst loader = document.querySelector('.loader');\n\nloader.classList.remove('is-hidden');\n\n\n\nfetchBreeds()\n  .then(({ data }) => renderSelectOptions(data))\n  .catch(e => notifications.error(e))\n  .finally(() => {\n    loader.classList.add('is-hidden');\n    selectEl.classList.remove('is-hidden');\n  })\n\nselectEl.addEventListener('change', handleSelectChange);\n\nasync function handleSelectChange(e) {\n  catInfo.innerHTML = '';\n  gallery.innerHTML = '';\n  loader.classList.remove('is-hidden');\n  const breedId = e.target.value;\n\n  try {\n    const [catResponse, breedImagesResponse] = await Promise.all([\n      fetchCatByBreed(breedId),\n      fetchBreedImages(breedId),\n    ]);\n\n    const { data: catData } = catResponse;\n    renderCatInfo(catData[0]);\n\n    const { data: breedImages } = breedImagesResponse;\n    gallery.innerHTML = breedImages\n      .filter(el => el.width > el.height)\n      .map(({url, id}) => {\n        return `<li class=\"cat-gallery_item\">\n            <div>\n              <img\n                class=\"cat-gallery_image\"\n                src=\"${url}\" alt=\"\"\n              >\n              <img\n                data-image-id=\"${id}\"\n                class=\"cat-gallery_icon\"\n                src=\"./img/heart.svg\" alt=\"heart-icon\"\n              >\n            </div>\n          </li>`;\n      })\n      .join('');\n\n    gallery.addEventListener('click', handleFavIconClick)\n\n  } catch (error) {\n    notifications.error(e);\n  } finally {\n    loader.classList.add('is-hidden');\n  }\n}\n\nfunction renderSelectOptions(arr) {\n  const markup = arr\n    .map(\n      ({ id, name }) =>\n      `<option value=\"${id}\">${name}</option>`\n    )\n    .join(\"\");\n\n  selectEl.innerHTML = markup;\n\n   new SlimSelect({\n     select: \".breed-form_select\",\n   });\n}\n\nfunction renderCatInfo(object) {\n  const { temperament, name, description } = object.breeds[0];\n\n  const markup = `\n        <div>\n          <img class=\"cat-info_image\" src=\"${object.url}\" alt=\"\">\n        </div>\n        <div>\n          <h2 class=\"cat-info_name\">${name}</h2>\n          <p class=\"cat-info_temper\">${temperament}</p>\n          <p class=\"cat-info_description\">${description}</p>\n        </div>\n      `;\n\n  catInfo.innerHTML = markup;\n}\n\nasync function handleFavIconClick(e) {\n  if (!e.target.classList.contains('cat-gallery_icon')) {\n    return;\n  }\n\n  const imageId = e.target.dataset.imageId;\n\n  try {\n    const favorites = await getFavourites();\n\n    if (favorites.data.find((el) => el.image_id === imageId)) {\n      notifications.alreadyInFavariotes();\n      return;\n    }\n\n    await saveImageToFavorites(imageId);\n    notifications.addedToFavorites();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n\n\n\n\n\n\n\n"],"names":["selectEl","gallery","catInfo","loader","fetchBreeds","data","renderSelectOptions","notifications","handleSelectChange","breedId","catResponse","breedImagesResponse","fetchCatByBreed","fetchBreedImages","catData","renderCatInfo","breedImages","el","url","id","handleFavIconClick","arr","markup","name","SlimSelect","object","temperament","description","imageId","getFavourites","saveImageToFavorites","error"],"mappings":"qIAWA,MAAMA,EAAW,SAAS,cAAc,oBAAoB,EACxC,SAAS,cAAc,eAAe,EAC1D,MAAMC,EAAU,SAAS,cAAc,cAAc,EAC/CC,EAAU,SAAS,cAAc,WAAW,EAC5CC,EAAS,SAAS,cAAc,SAAS,EAE/CA,EAAO,UAAU,OAAO,WAAW,EAInCC,EAAa,EACV,KAAK,CAAC,CAAE,KAAAC,CAAM,IAAKC,EAAoBD,CAAI,CAAC,EAC5C,MAAM,GAAKE,EAAc,MAAM,CAAC,CAAC,EACjC,QAAQ,IAAM,CACbJ,EAAO,UAAU,IAAI,WAAW,EAChCH,EAAS,UAAU,OAAO,WAAW,CACzC,CAAG,EAEHA,EAAS,iBAAiB,SAAUQ,CAAkB,EAEtD,eAAeA,EAAmB,EAAG,CACnCN,EAAQ,UAAY,GACpBD,EAAQ,UAAY,GACpBE,EAAO,UAAU,OAAO,WAAW,EACnC,MAAMM,EAAU,EAAE,OAAO,MAEzB,GAAI,CACF,KAAM,CAACC,EAAaC,CAAmB,EAAI,MAAM,QAAQ,IAAI,CAC3DC,EAAgBH,CAAO,EACvBI,EAAiBJ,CAAO,CAC9B,CAAK,EAEK,CAAE,KAAMK,CAAS,EAAGJ,EAC1BK,EAAcD,EAAQ,CAAC,CAAC,EAExB,KAAM,CAAE,KAAME,CAAa,EAAGL,EAC9BV,EAAQ,UAAYe,EACjB,OAAOC,GAAMA,EAAG,MAAQA,EAAG,MAAM,EACjC,IAAI,CAAC,CAAC,IAAAC,EAAK,GAAAC,CAAE,IACL;AAAA;AAAA;AAAA;AAAA,uBAIQD,CAAG;AAAA;AAAA;AAAA,iCAGOC,CAAE;AAAA;AAAA;AAAA;AAAA;AAAA,gBAM5B,EACA,KAAK,EAAE,EAEVlB,EAAQ,iBAAiB,QAASmB,CAAkB,CAErD,MAAe,CACdb,EAAc,MAAM,CAAC,CACzB,QAAY,CACRJ,EAAO,UAAU,IAAI,WAAW,CACjC,CACH,CAEA,SAASG,EAAoBe,EAAK,CAChC,MAAMC,EAASD,EACZ,IACC,CAAC,CAAE,GAAAF,EAAI,KAAAI,CAAM,IACb,kBAAkBJ,CAAE,KAAKI,CAAI,WAC9B,EACA,KAAK,EAAE,EAEVvB,EAAS,UAAYsB,EAEpB,IAAIE,EAAW,CACb,OAAQ,oBACb,CAAI,CACJ,CAEA,SAAST,EAAcU,EAAQ,CAC7B,KAAM,CAAE,YAAAC,EAAa,KAAAH,EAAM,YAAAI,CAAa,EAAGF,EAAO,OAAO,CAAC,EAEpDH,EAAS;AAAA;AAAA,6CAE4BG,EAAO,GAAG;AAAA;AAAA;AAAA,sCAGjBF,CAAI;AAAA,uCACHG,CAAW;AAAA,4CACNC,CAAW;AAAA;AAAA,QAIrDzB,EAAQ,UAAYoB,CACtB,CAEA,eAAeF,EAAmB,EAAG,CACnC,GAAI,CAAC,EAAE,OAAO,UAAU,SAAS,kBAAkB,EACjD,OAGF,MAAMQ,EAAU,EAAE,OAAO,QAAQ,QAEjC,GAAI,CAGF,IAFkB,MAAMC,KAEV,KAAK,KAAMZ,GAAOA,EAAG,WAAaW,CAAO,EAAG,CACxDrB,EAAc,oBAAmB,EACjC,MACD,CAED,MAAMuB,EAAqBF,CAAO,EAClCrB,EAAc,iBAAgB,CAC/B,OAAQwB,EAAO,CACd,QAAQ,IAAIA,CAAK,CAClB,CACH"}