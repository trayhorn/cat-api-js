{"version":3,"file":"cat-gallery.js","sources":["../src/js/cat-gallery.js"],"sourcesContent":["import { getFavourites, getImageById, deleteFavourite } from './api';\nimport { notifications } from '../utils/notifications';\n\n\nconst gallery = document.querySelector('.fav-gallery');\nconst loader = document.querySelector('.loader');\n\nloader.classList.remove('is-hidden');\n\nrenderFavourites();\n\nasync function renderFavourites() {\n  try {\n    const { data } = await getFavourites();\n    const favIds = data.map(el => el.image_id);\n\n    const images = await Promise.all(\n      favIds.map(async id => {\n        const { data: image } = await getImageById(id);\n        return image;\n      })\n    );\n\n    gallery.innerHTML = images\n      .map(({url, id}) => {\n        return `<li class=\"fav-gallery_item\">\n              <img\n                class=\"fav-gallery_image\"\n                src=\"${url}\" alt=\"\"\n              >\n              <button class=\"fav-image_button\">\n                <img \n                  class=\"fav-image_icon\"\n                  data-image-id=\"${id}\"\n                  src=\"./img/cancel-circle.svg\" alt=\"\"\n                >\n              </button>\n          </li>`;\n      })\n      .join('');\n  \n    handleDeleteFav();\n\n  } catch (e) {\n    notifications.error(e);\n  } finally {\n    loader.classList.add('is-hidden');\n  }\n\n}\n\nfunction handleDeleteFav() {\n  gallery.addEventListener('click', async (e) => {\n    if (!e.target.classList.contains('fav-image_icon')) {\n      return;\n    }\n\n    const image_id = e.target.dataset.imageId;\n\n    const { data: allFavs } = await getFavourites();\n    const data = allFavs.filter(el => el.image_id === image_id);\n    const idToDelete = data[0].id;\n    deleteFavourite(idToDelete);\n  });\n}"],"names":["gallery","loader","renderFavourites","data","getFavourites","favIds","el","images","id","image","getImageById","url","handleDeleteFav","e","notifications","image_id","allFavs","idToDelete","deleteFavourite"],"mappings":"gHAIA,MAAMA,EAAU,SAAS,cAAc,cAAc,EAC/CC,EAAS,SAAS,cAAc,SAAS,EAE/CA,EAAO,UAAU,OAAO,WAAW,EAEnCC,IAEA,eAAeA,GAAmB,CAChC,GAAI,CACF,KAAM,CAAE,KAAAC,CAAI,EAAK,MAAMC,IACjBC,EAASF,EAAK,IAAIG,GAAMA,EAAG,QAAQ,EAEnCC,EAAS,MAAM,QAAQ,IAC3BF,EAAO,IAAI,MAAMG,GAAM,CACrB,KAAM,CAAE,KAAMC,CAAK,EAAK,MAAMC,EAAaF,CAAE,EAC7C,OAAOC,CACf,CAAO,CACP,EAEIT,EAAQ,UAAYO,EACjB,IAAI,CAAC,CAAC,IAAAI,EAAK,GAAAH,CAAE,IACL;AAAA;AAAA;AAAA,uBAGQG,CAAG;AAAA;AAAA;AAAA;AAAA;AAAA,mCAKSH,CAAE;AAAA;AAAA;AAAA;AAAA,gBAK9B,EACA,KAAK,EAAE,EAEVI,GAED,OAAQC,EAAG,CACVC,EAAc,MAAMD,CAAC,CACzB,QAAY,CACRZ,EAAO,UAAU,IAAI,WAAW,CACjC,CAEH,CAEA,SAASW,GAAkB,CACzBZ,EAAQ,iBAAiB,QAAS,MAAOa,GAAM,CAC7C,GAAI,CAACA,EAAE,OAAO,UAAU,SAAS,gBAAgB,EAC/C,OAGF,MAAME,EAAWF,EAAE,OAAO,QAAQ,QAE5B,CAAE,KAAMG,GAAY,MAAMZ,EAAa,EAEvCa,EADOD,EAAQ,OAAOV,GAAMA,EAAG,WAAaS,CAAQ,EAClC,CAAC,EAAE,GAC3BG,EAAgBD,CAAU,CAC9B,CAAG,CACH"}