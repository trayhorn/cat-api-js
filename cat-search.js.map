{"version":3,"file":"cat-search.js","sources":["../src/js/render-functions.js","../src/js/cat-search.js"],"sourcesContent":["export function renderCatInfo(object) {\n  const {\n    url,\n    breeds: [{ temperament, name, description }],\n  } = object;\n\n  return `\n    <div>\n      <img class=\"image\" src=\"${url}\" alt=\"${name}\">\n    </div>\n    <div>\n      <h2 class=\"name\">${name}</h2>\n      <p class=\"temper\">${temperament}</p>\n      <p class=\"description\">${description}</p>\n    </div>\n  `;\n}\n\nexport function renderCatImages(data) {\n  return data\n    .map(({ url, id, width, height }) => {\n      return `\n        <li class='item ${width < height ? \"vertical\" : \"\"}'>\n          <div>\n            <img\n              class=\"image\"\n              src=\"${url}\" alt=\"\"\n            >\n            <img\n              data-image-id=\"${id}\"\n              class=\"icon\"\n              src=\"./img/heart.svg\" alt=\"heart-icon\"\n            >\n          </div>\n        </li>`;\n    })\n    .join(\"\");\n}","import {\n  fetchBreeds,\n  fetchCatByBreed,\n  fetchBreedImages,\n  saveImageToFavorites,\n  getFavourites,\n  deleteFavourite\n} from \"./api\";\nimport { renderCatInfo, renderCatImages } from \"./render-functions\";\nimport { notifications } from '../utils/notifications';\nimport SlimSelect from \"slim-select\";\n\n\nconst select = document.querySelector('.breed-form .select');\nconst gallery = document.querySelector('.search-gallery');\nconst catInfo = document.querySelector('.cat-info');\nconst loader = document.querySelector('.loader');\n\nloader.classList.remove('is-hidden');\n\n\ngetItemsFromStorage();\n\nfetchBreedsTest();\n\nselect.addEventListener('change', handleSelectChange);\n\n//Functions\n\nasync function fetchBreedsTest() {\n  try {\n    const { data } = await fetchBreeds();\n    renderSelectOptions(data);\n  } catch (e) {\n    notifications.error(e);\n  } finally {\n    loader.classList.add(\"is-hidden\");\n    select.classList.remove(\"is-hidden\");\n  }\n}\n\nfunction renderSelectOptions(arr) {\n  const markup = arr.map(\n      ({ id, name }) =>\n        `<option class=\"select-option\" value=\"${id}\">${name}</option>`\n    ).join(\"\");\n\n  select.insertAdjacentHTML('beforeend', markup);\n\n  new SlimSelect({\n    select: \".breed-form .select\",\n  });\n}\n\nasync function handleSelectChange(e) {\n  catInfo.innerHTML = '';\n  gallery.innerHTML = '';\n  loader.classList.remove('is-hidden');\n  const breedId = e.target.value;\n\n  try {\n    const [catResponse, breedImagesResponse] = await Promise.all([\n      fetchCatByBreed(breedId),\n      fetchBreedImages(breedId),\n    ]);\n\n    const { data: [catData] } = catResponse;\n    localStorage.setItem('catInfo', JSON.stringify(catData));\n    catInfo.innerHTML = renderCatInfo(catData);\n\n    const { data: breedImages } = breedImagesResponse;\n    localStorage.setItem('catImages', JSON.stringify(breedImages));\n    gallery.innerHTML = renderCatImages(breedImages);\n\n    gallery.addEventListener('click', handleFavIconClick)\n\n  } catch (error) {\n    notifications.error(e);\n  } finally {\n    loader.classList.add('is-hidden');\n  }\n}\n\nasync function handleFavIconClick(e) {\n  if (!e.target.classList.contains('icon')) {\n    return;\n  }\n\n  const { imageId } = e.target.dataset;\n  e.target.setAttribute(\"src\", \"./img/heart-broken.svg\");\n\n  try {\n    const favorites = await getFavourites();\n\n    if (favorites.data.find((el) => el.image_id === imageId)) {\n      const elementToDelete = favorites.data.find(\n        (el) => el.image_id === imageId\n      );\n      e.target.setAttribute(\"src\", \"./img/heart.svg\");\n      await deleteFavourite(elementToDelete.id);\n      notifications.removedFromFavorites();\n      return;\n    }\n\n    await saveImageToFavorites(imageId);\n    notifications.addedToFavorites();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction getItemsFromStorage() {\n  if (!localStorage.getItem(\"catInfo\") ||\n    !localStorage.getItem(\"catImages\")) {\n    return;\n  }\n\n  catInfo.innerHTML = renderCatInfo(\n    JSON.parse(localStorage.getItem(\"catInfo\"))\n  );\n  gallery.innerHTML = renderCatImages(\n    JSON.parse(localStorage.getItem(\"catImages\"))\n  );\n}"],"names":["renderCatInfo","object","url","temperament","name","description","renderCatImages","data","id","width","height","select","gallery","catInfo","loader","getItemsFromStorage","fetchBreedsTest","handleSelectChange","fetchBreeds","renderSelectOptions","notifications","arr","markup","SlimSelect","breedId","catResponse","breedImagesResponse","fetchCatByBreed","fetchBreedImages","catData","breedImages","handleFavIconClick","imageId","favorites","getFavourites","el","elementToDelete","deleteFavourite","saveImageToFavorites","error"],"mappings":"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"}